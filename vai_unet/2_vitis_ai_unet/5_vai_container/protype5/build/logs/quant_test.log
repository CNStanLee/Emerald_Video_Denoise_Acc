No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'

[0;32m[VAIQ_NOTE]: Loading NNDCT kernels...[0m

-----------------------------------------
PyTorch version :  1.13.1
3.8.6 | packaged by conda-forge | (default, Oct  7 2020, 19:08:05) 
[GCC 7.5.0]
-----------------------------------------
 Command line options:
--build_dir    :  ./build
--quant_mode   :  test
--batchsize    :  100
-----------------------------------------
No CUDA devices available..selecting CPU

[0;33m[VAIQ_WARN][QUANTIZER_TORCH_CUDA_UNAVAILABLE]: CUDA (HIP) is not available, change device to CPU[0m

[0;32m[VAIQ_NOTE]: OS and CPU information:
               system --- Linux
                 node --- changhong-Dell-Pro-Max-Tower-T2-FCT2250
              release --- 6.8.0-60-generic
              version --- #63~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Apr 22 19:00:15 UTC 2
              machine --- x86_64
            processor --- x86_64[0m

[0;32m[VAIQ_NOTE]: Tools version information:
                  GCC --- GCC 7.5.0
               python --- 3.8.6
              pytorch --- 1.13.1
        vai_q_pytorch --- 3.5.0+60df3f1+torch1.13.1[0m

[0;33m[VAIQ_WARN][QUANTIZER_TORCH_CUDA_UNAVAILABLE]: CUDA (HIP) is not available, change device to CPU.[0m

[0;32m[VAIQ_NOTE]: Quant config file is empty, use default quant configuration[0m

[0;32m[VAIQ_NOTE]: Quantization test process start up...[0m

[0;32m[VAIQ_NOTE]: =>Quant Module is in 'cpu'.[0m

[0;32m[VAIQ_NOTE]: =>Parsing UnetGenerator...[0m

[0;32m[VAIQ_NOTE]: Start to trace and freeze model...[0m

[0;32m[VAIQ_NOTE]: The input model nndct_st_UnetGenerator_ed is torch.nn.Module.[0m

[0;32m[VAIQ_NOTE]: Finish tracing.[0m

[0;32m[VAIQ_NOTE]: Processing ops...[0m
                                                  | 0/41 [00:00<?, ?it/s]                                                  | 0/41 [00:00<?, ?it/s, OpInfo: name = input_0, type = Param]█▏                                                | 1/41 [00:00<00:00, 15887.52it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/Conv2d[0]/ret.3, type = _convolution]██▍                                               | 2/41 [00:00<00:00, 5071.71it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/LeakyReLU[0]/5246, type = leaky_relu_]███▋                                              | 3/41 [00:00<00:00, 5327.23it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/Conv2d[1]/ret.5, type = _convolution] ████▉                                             | 4/41 [00:00<00:00, 5765.37it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5270, type = leaky_relu_]██████                                            | 5/41 [00:00<00:00, 6385.97it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.7, type = _convolution] ███████▎                                          | 6/41 [00:00<00:00, 6577.58it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5294, type = leaky_relu_]████████▌                                         | 7/41 [00:00<00:00, 7022.27it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.9, type = _convolution] █████████▊                                        | 8/41 [00:00<00:00, 7134.69it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5318, type = leaky_relu_]██████████▉                                       | 9/41 [00:00<00:00, 7422.09it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.11, type = _convolution]████████████▏                                     | 10/41 [00:00<00:00, 7414.36it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5342, type = leaky_relu_]█████████████▍                                    | 11/41 [00:00<00:00, 7588.38it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.13, type = _convolution]██████████████▋                                   | 12/41 [00:00<00:00, 7466.50it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5366, type = leaky_relu_]███████████████▊                                  | 13/41 [00:00<00:00, 7570.95it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.15, type = _convolution]█████████████████                                 | 14/41 [00:00<00:00, 7498.44it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/LeakyReLU[0]/5390, type = leaky_relu_]██████████████████▎                               | 15/41 [00:00<00:00, 7570.95it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/Conv2d[1]/ret.17, type = _convolution]███████████████████▌                              | 16/41 [00:00<00:00, 7490.66it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[3]/5413, type = relu_]           ████████████████████▋                             | 17/41 [00:00<00:00, 7344.03it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[4]/ret.19, type = _convolution]█████████████████████▉                            | 18/41 [00:00<00:00, 7049.25it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.21, type = cat]                                              ███████████████████████▏                          | 19/41 [00:00<00:00, 6774.78it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[4]/5443, type = relu_]                   ████████████████████████▍                         | 20/41 [00:00<00:00, 6870.84it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[5]/ret.23, type = _convolution]█████████████████████████▌                        | 21/41 [00:00<00:00, 6844.92it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.25, type = cat]                                              ██████████████████████████▊                       | 22/41 [00:00<00:00, 6927.01it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[4]/5474, type = relu_]                   ████████████████████████████                      | 23/41 [00:00<00:00, 7039.48it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[5]/ret.27, type = _convolution]█████████████████████████████▎                    | 24/41 [00:00<00:00, 7034.47it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.29, type = cat]                                              ██████████████████████████████▍                   | 25/41 [00:00<00:00, 7118.16it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[4]/5505, type = relu_]                   ███████████████████████████████▋                  | 26/41 [00:00<00:00, 7194.82it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[5]/ret.31, type = _convolution]████████████████████████████████▉                 | 27/41 [00:00<00:00, 7202.12it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.33, type = cat]                                              ██████████████████████████████████▏               | 28/41 [00:00<00:00, 7295.35it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[4]/5536, type = relu_]                   ███████████████████████████████████▎              | 29/41 [00:00<00:00, 7411.33it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[5]/ret.35, type = _convolution]████████████████████████████████████▌             | 30/41 [00:00<00:00, 7436.27it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.37, type = cat]                                              █████████████████████████████████████▊            | 31/41 [00:00<00:00, 7527.12it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ReLU[4]/5566, type = relu_]                   ███████████████████████████████████████           | 32/41 [00:00<00:00, 7644.25it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/Sequential[model]/ConvTranspose2d[5]/ret.39, type = _convolution]████████████████████████████████████████▏         | 33/41 [00:00<00:00, 7674.21it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/UnetSkipConnectionBlock[3]/ret.41, type = cat]                                              █████████████████████████████████████████▍        | 34/41 [00:00<00:00, 7763.85it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/ReLU[4]/5596, type = relu_]                   ██████████████████████████████████████████▋       | 35/41 [00:00<00:00, 7880.64it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/Sequential[model]/ConvTranspose2d[5]/ret.43, type = _convolution]███████████████████████████████████████████▉      | 36/41 [00:00<00:00, 7912.54it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/UnetSkipConnectionBlock[1]/ret.45, type = cat]                                              █████████████████████████████████████████████     | 37/41 [00:00<00:00, 8007.70it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/ReLU[2]/5626, type = relu_]                   ██████████████████████████████████████████████▎   | 38/41 [00:00<00:00, 8125.18it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/ConvTranspose2d[3]/ret.47, type = _convolution]███████████████████████████████████████████████▌  | 39/41 [00:00<00:00, 8148.74it/s, OpInfo: name = UnetGenerator/UnetSkipConnectionBlock[model]/Sequential[model]/ReLU[4]/ret, type = relu]                      ████████████████████████████████████████████████▊ | 40/41 [00:00<00:00, 8237.86it/s, OpInfo: name = return_0, type = Return]                                                                ██████████████████████████████████████████████████| 41/41 [00:00<00:00, 8368.60it/s, OpInfo: name = return_0, type = Return]

[0;32m[VAIQ_NOTE]: =>Doing weights equalization...[0m

[0;33m[VAIQ_WARN][QUANTIZER_TORCH_LEAKYRELU]: Force to change negative_slope of LeakyReLU from 0.1 to 0.1015625 because DPU only supports this value. It is recommended to change all negative_slope of LeakyReLU to 0.1015625 and re-train the float model for better deployed model accuracy.[0m

[0;32m[VAIQ_NOTE]: =>Quantizable module is generated.(./build/quant_model/UnetGenerator.py)[0m

[0;32m[VAIQ_NOTE]: =>Get module with quantization.[0m
Test Loss: 0.0408

[0;32m[VAIQ_NOTE]: =>Converting to xmodel ...[0m

[0;32m[VAIQ_NOTE]: =>Successfully convert 'UnetGenerator' to xmodel.(./build/quant_model/UnetGenerator_int.xmodel)[0m
